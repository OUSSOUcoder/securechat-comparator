<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prot√®ge ton Message!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        let gameState = 'intro';
        let selectedApp = null;
        let score = 100;
        let round = 0;
        let events = [];
        let timeLeft = 30;
        let finalScore = 0;
        let timerInterval = null;

        const apps = {
            signal: { name: 'Signal', icon: 'üîµ', color: '#2E86DE', baseDefense: 95, strengths: ['e2ee', 'metadata', 'openSource'], weaknesses: ['endpoint'] },
            telegram: { name: 'Telegram', icon: 'üü¢', color: '#26A69A', baseDefense: 45, strengths: ['features', 'speed'], weaknesses: ['e2ee', 'metadata', 'serverSecurity'] },
            whatsapp: { name: 'WhatsApp', icon: 'üü†', color: '#EE6C4D', baseDefense: 70, strengths: ['e2ee', 'userBase'], weaknesses: ['metadata', 'metaIntegration', 'closedSource'] }
        };

        const threats = [
            { name: 'Attaque Wi-Fi Public', icon: 'üì°', damage: 30, blockedBy: ['e2ee'], description: 'Un hacker intercepte sur r√©seau non s√©curis√©' },
            { name: 'Collecte M√©tadonn√©es', icon: 'üëÅÔ∏è', damage: 25, blockedBy: ['metadata'], description: 'Analyse de qui parle √† qui et quand' },
            { name: 'Compromission Serveur', icon: 'üñ•Ô∏è', damage: 40, blockedBy: ['e2ee', 'openSource'], description: 'Serveur pirat√©, donn√©es expos√©es' },
            { name: 'Malware Pegasus', icon: 'ü¶†', damage: 50, blockedBy: [], description: 'Spyware sur votre appareil' },
            { name: 'Demande Gouvernementale', icon: 'üèõÔ∏è', damage: 35, blockedBy: ['e2ee', 'metadata'], description: 'Autorit√©s exigent acc√®s aux donn√©es' },
            { name: 'Partage avec Tiers', icon: 'üîÑ', damage: 30, blockedBy: ['metadata', 'openSource'], description: 'Donn√©es vendues √† annonceurs' }
        ];

        function startGame(appKey) {
            selectedApp = appKey;
            gameState = 'playing';
            score = 100;
            round = 0;
            events = [];
            timeLeft = 30;
            render();
            startTimer();
            triggerThreat();
        }

        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                if (timeLeft <= 0) {
                    endGame();
                }
                render();
            }, 1000);
        }

        function triggerThreat() {
            if (round >= 10 || gameState !== 'playing') {
                endGame();
                return;
            }

            const threat = threats[Math.floor(Math.random() * threats.length)];
            const app = apps[selectedApp];
            const isBlocked = threat.blockedBy.some(defense => app.strengths.includes(defense));
            const damage = isBlocked ? Math.floor(threat.damage * 0.2) : threat.damage;
            
            score = Math.max(0, score - damage);
            
            events.push({
                round: round + 1,
                threat: threat.name,
                icon: threat.icon,
                blocked: isBlocked,
                damage: damage,
                description: threat.description
            });
            
            round++;
            render();
            
            if (score <= 0) {
                endGame();
            } else if (round < 10) {
                setTimeout(triggerThreat, 3000);
            } else {
                endGame();
            }
        }

        function endGame() {
            if (timerInterval) clearInterval(timerInterval);
            const timeBonus = timeLeft * 2;
            const survivalBonus = score > 50 ? 50 : 0;
            finalScore = score + timeBonus + survivalBonus;
            gameState = 'result';
            render();
        }

        function reset() {
            if (timerInterval) clearInterval(timerInterval);
            gameState = 'intro';
            selectedApp = null;
            score = 100;
            round = 0;
            events = [];
            timeLeft = 30;
            finalScore = 0;
            render();
        }

        function getRank(score) {
            if (score >= 200) return { rank: 'Expert S√©curit√©', emoji: 'üèÜ', color: 'text-yellow-400' };
            if (score >= 150) return { rank: 'Bien Prot√©g√©', emoji: 'ü•à', color: 'text-gray-300' };
            if (score >= 100) return { rank: 'Vigilant', emoji: 'ü•â', color: 'text-orange-400' };
            if (score >= 50) return { rank: '√Ä Risque', emoji: '‚ö†Ô∏è', color: 'text-orange-600' };
            return { rank: 'Compromis', emoji: 'üíÄ', color: 'text-red-600' };
        }

        function render() {
            const app = document.getElementById('app');
            
            app.innerHTML = `
                <div class="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-8">
                    <div class="max-w-6xl mx-auto">
                        <div class="text-center mb-8">
                            <h1 class="text-5xl font-bold text-white mb-2 flex items-center justify-center gap-3">
                                üõ°Ô∏è Prot√®ge ton Message!
                            </h1>
                            <p class="text-xl text-gray-300">Jeu Interactif: Choisis ton app et r√©siste aux cyberattaques!</p>
                        </div>

                        ${gameState === 'intro' ? `
                            <div class="space-y-8">
                                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-8 border border-white/20 text-center">
                                    <h2 class="text-3xl font-bold text-white mb-4">üéØ Mission</h2>
                                    <p class="text-xl text-gray-300 mb-6">
                                        Tu dois envoyer un message confidentiel. Choisis ton application de messagerie
                                        et survie face √† 10 vagues de cyberattaques pendant 30 secondes!
                                    </p>
                                    <div class="grid grid-cols-3 gap-4 text-left">
                                        <div class="bg-green-500/20 p-4 rounded-lg border border-green-500">
                                            <div class="text-2xl mb-2">üíØ</div>
                                            <div class="text-white font-bold">Commence √† 100 points</div>
                                            <div class="text-sm text-gray-300">Chaque attaque retire des points</div>
                                        </div>
                                        <div class="bg-blue-500/20 p-4 rounded-lg border border-blue-500">
                                            <div class="text-2xl mb-2">‚è±Ô∏è</div>
                                            <div class="text-white font-bold">30 secondes</div>
                                            <div class="text-sm text-gray-300">Bonus temps restant</div>
                                        </div>
                                        <div class="bg-purple-500/20 p-4 rounded-lg border border-purple-500">
                                            <div class="text-2xl mb-2">üõ°Ô∏è</div>
                                            <div class="text-white font-bold">10 vagues d'attaques</div>
                                            <div class="text-sm text-gray-300">Survie = Victoire</div>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h2 class="text-3xl font-bold text-white mb-6 text-center">Choisis ton Application</h2>
                                    <div class="grid grid-cols-3 gap-6">
                                        ${Object.entries(apps).map(([key, app]) => `
                                            <button onclick="startGame('${key}')" class="p-8 rounded-xl border-4 transition-all hover:scale-105 bg-white/10 hover:bg-white/20" style="border-color: ${app.color};">
                                                <div class="text-6xl mb-4">${app.icon}</div>
                                                <div class="text-white font-bold text-2xl mb-3">${app.name}</div>
                                                <div class="space-y-2 text-sm">
                                                    <div class="bg-green-500/20 px-3 py-2 rounded text-green-300">D√©fense: ${app.baseDefense}%</div>
                                                    <div class="text-gray-300">
                                                        <div class="font-bold mb-1">Forces:</div>
                                                        ${app.strengths.map(s => `<div class="text-xs">‚úì ${s}</div>`).join('')}
                                                    </div>
                                                </div>
                                            </button>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        ` : gameState === 'playing' ? `
                            <div class="space-y-6">
                                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
                                    <div class="grid grid-cols-4 gap-6">
                                        <div class="text-center">
                                            <div class="text-4xl font-bold mb-2" style="color: ${apps[selectedApp].color};">${apps[selectedApp].icon}</div>
                                            <div class="text-white font-bold">${apps[selectedApp].name}</div>
                                        </div>
                                        
                                        <div class="text-center">
                                            <div class="flex items-center justify-center gap-2 mb-2">
                                                <span class="text-2xl">üõ°Ô∏è</span>
                                                <div class="text-4xl font-bold text-white">${score}</div>
                                            </div>
                                            <div class="text-gray-300">Points de S√©curit√©</div>
                                            <div class="w-full bg-gray-700 rounded-full h-3 mt-2">
                                                <div class="h-3 rounded-full transition-all duration-500" style="width: ${score}%; background-color: ${score > 70 ? '#22c55e' : score > 30 ? '#f59e0b' : '#ef4444'};"></div>
                                            </div>
                                        </div>
                                        
                                        <div class="text-center">
                                            <div class="flex items-center justify-center gap-2 mb-2">
                                                <span class="text-2xl">üéØ</span>
                                                <div class="text-4xl font-bold text-white">${round}/10</div>
                                            </div>
                                            <div class="text-gray-300">Vague d'Attaque</div>
                                        </div>
                                        
                                        <div class="text-center">
                                            <div class="flex items-center justify-center gap-2 mb-2">
                                                <span class="text-2xl ${timeLeft <= 10 ? 'animate-pulse' : ''}">‚è±Ô∏è</span>
                                                <div class="text-4xl font-bold ${timeLeft <= 10 ? 'text-red-400' : 'text-white'}">${timeLeft}s</div>
                                            </div>
                                            <div class="text-gray-300">Temps Restant</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20">
                                    <h3 class="text-2xl font-bold text-white mb-4 flex items-center gap-2">
                                        ‚ö° Journal des Attaques
                                    </h3>
                                    <div class="space-y-3 max-h-96 overflow-y-auto">
                                        ${events.slice().reverse().map(event => `
                                            <div class="p-4 rounded-lg border-2 animate-fadeIn ${
                                                event.blocked ? 'bg-green-500/20 border-green-500' : 'bg-red-500/20 border-red-500'
                                            }">
                                                <div class="flex items-start justify-between">
                                                    <div class="flex items-start gap-3">
                                                        <div class="text-3xl">${event.icon}</div>
                                                        <div>
                                                            <div class="text-white font-bold">Vague ${event.round}: ${event.threat}</div>
                                                            <div class="text-sm text-gray-300">${event.description}</div>
                                                        </div>
                                                    </div>
                                                    <div class="px-4 py-2 rounded-lg font-bold ${
                                                        event.blocked ? 'bg-green-600 text-white' : 'bg-red-600 text-white'
                                                    }">
                                                        ${event.blocked ? `‚úì BLOQU√â (-${event.damage})` : `‚úó HIT (-${event.damage})`}
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        ` : `
                            <div class="space-y-6">
                                <div class="p-12 rounded-2xl border-4 text-center ${
                                    finalScore >= 150 ? 'bg-green-500/20 border-green-500' : 
                                    finalScore >= 100 ? 'bg-yellow-500/20 border-yellow-500' : 'bg-red-500/20 border-red-500'
                                }">
                                    <div class="text-8xl mb-6">${getRank(finalScore).emoji}</div>
                                    <h2 class="text-5xl font-bold mb-4 ${getRank(finalScore).color}">${getRank(finalScore).rank}</h2>
                                    <div class="text-white text-2xl mb-8">Score Final: ${finalScore} points</div>
                                    
                                    <div class="grid grid-cols-3 gap-6 mb-8">
                                        <div class="bg-white/10 p-4 rounded-lg">
                                            <div class="text-3xl font-bold text-white">${score}</div>
                                            <div class="text-gray-300">S√©curit√© Restante</div>
                                        </div>
                                        <div class="bg-white/10 p-4 rounded-lg">
                                            <div class="text-3xl font-bold text-white">+${timeLeft * 2}</div>
                                            <div class="text-gray-300">Bonus Temps</div>
                                        </div>
                                        <div class="bg-white/10 p-4 rounded-lg">
                                            <div class="text-3xl font-bold text-white">+${score > 50 ? 50 : 0}</div>
                                            <div class="text-gray-300">Bonus Survie</div>
                                        </div>
                                    </div>

                                    <div class="bg-black/30 rounded-xl p-6 text-left">
                                        <h3 class="text-white font-bold text-xl mb-4">üìä Statistiques</h3>
                                        <div class="space-y-2 text-white">
                                            <div class="flex justify-between">
                                                <span>Application utilis√©e:</span>
                                                <span class="font-bold">${apps[selectedApp].name}</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span>Vagues surv√©cues:</span>
                                                <span class="font-bold">${round}/10</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span>Attaques bloqu√©es:</span>
                                                <span class="font-bold">${events.filter(e => e.blocked).length}</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span>Attaques r√©ussies:</span>
                                                <span class="font-bold">${events.filter(e => !e.blocked).length}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-blue-500/20 border border-blue-500/50 rounded-xl p-6">
                                    <h3 class="text-blue-300 font-bold text-xl mb-4">üí° Ce que tu as appris</h3>
                                    <div class="text-white space-y-3">
                                        ${selectedApp === 'signal' ? `
                                            <p>‚úì <strong>Signal</strong> offre la meilleure protection avec E2EE par d√©faut</p>
                                            <p>‚úì M√™me face √† des attaques sophistiqu√©es, tes messages restent s√©curis√©s</p>
                                            <p>‚úì La seule vraie vuln√©rabilit√©: compromission de ton appareil (Pegasus)</p>
                                        ` : selectedApp === 'telegram' ? `
                                            <p>‚ö†Ô∏è <strong>Telegram</strong> est vuln√©rable sans Secret Chats activ√©s</p>
                                            <p>‚ö†Ô∏è Les messages normaux ne sont PAS prot√©g√©s par E2EE</p>
                                            <p>‚ö†Ô∏è Privil√©gie <strong>Signal</strong> pour communications sensibles</p>
                                        ` : `
                                            <p>‚ö†Ô∏è <strong>WhatsApp</strong> prot√®ge le contenu mais collecte m√©tadonn√©es</p>
                                            <p>‚ö†Ô∏è Donn√©es partag√©es avec Meta pour publicit√© cibl√©e</p>
                                            <p>‚ö†Ô∏è Pour confidentialit√© maximale, utilise <strong>Signal</strong></p>
                                        `}
                                    </div>
                                </div>

                                <button onclick="reset()" class="w-full px-8 py-6 bg-blue-600 hover:bg-blue-700 text-white font-bold text-xl rounded-xl transition-all flex items-center justify-center gap-3">
                                    üèÜ Rejouer
                                </button>
                            </div>
                        `}
                    </div>
                </div>
            `;
        }

        window.startGame = startGame;
        window.reset = reset;

        render();
    </script>
</body>
</html>